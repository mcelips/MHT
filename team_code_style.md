# Стиль оформления скриптов (Harvey Monster Team)

Данный документ опирается на стандарты PSR.

# Файлы

## Имена файлов

К имени файлов, которые относятся к базовому функционалу, СЛЕДУЕТ в начало нижнее подчеркивание. Это позволит легко
находить "базовые файлы" для отладки, расширения функционала и переноса в другой проект. Примеры именования
файлов: `_config.php`, `_errors.php` и т.д.

В начало имени файлов проекта ЗАПРЕЩАЕТСЯ добавлять какие-либо символы. Имя файла всегда должно начинаться с буквы в
нижнем регистре.

ЗАПРЕЩАЕТСЯ использовать в имени файлов стиль camelCase или смешивать стили. Слова необходимо разделять нижним
подчеркиванием. Например, `getAllShips.php` или `get_allShips` - неверно, `get_all_ships.php` - верно.

## Кодировка

PHP код ДОЛЖЕН использовать только UTF-8 без BOM.

# Рекомендации по оформлению кода

## PHP-теги

В PHP коде ДОЛЖЕН использоваться длинный тег `<?php ... ?>` или сокращенный echo-тег `<?= ... ?>`; в коде НЕ ДОЛЖНО
использоваться других вариантов тегов.

Закрывающий тег `?>` ДОЛЖЕН отсутствовать в файлах, содержащих только PHP-код.

```html
<!-- Под вопросом -->
В конце каждого файла с PHP-кодом ДОЛЖНА быть одна пустая строка.
```

## Отступы

Для оформления отступов ДОЛЖНЫ использоваться четыре пробела (но не знак табуляции).

_Примечание:_ использование только лишь пробелов (без смешивания их с табуляциями) позволяет избежать проблем с
обработкой истории изменения кода, определением самих изменений, патчами и комментариями. Использование пробелов также
позволяет легко добавлять небольшие отступы для выравнивания отдельных вложенных строк.

## Ключевые слова и константы true / false / null

* Ключевые слова PHP ДОЛЖНЫ быть написаны в нижнем регистре.
* Константы PHP `true`, `false` и `null` ДОЛЖНЫ быть написаны в нижнем регистре.

## Переменные

```php
// Требует заполнения
// https://habr.com/ru/post/486738/
// Стили написания camelCase и snake_case
```

## Функции

Имена методов ДОЛЖНЫ быть объявлены с использованием т.н. «snake_case» (слова разделяются символом подчеркивания).

После имени функции НЕ ДОЛЖНО быть пробела. Открывающая фигурная скобка ДОЛЖНА находиться на отдельной строке, а
закрывающая фигурная скобка ДОЛЖНА находиться на следующей за телом метода строке. НЕ ДОЛЖНО быть пробелов после
открывающей и перед закрывающей круглыми скобками в определении метода.

В общем случае определение функции выглядит так. Обратите внимание на круглые скобки, запятые, пробелы и фигурные
скобки:

```php
<?php
function foo_bar_baz($arg1, &$arg2, $arg3 = [])
{
    // тело функции
}
```

### Аргументы функций:

В списке аргументов НЕ ДОЛЖНО быть пробела перед запятыми, но ДОЛЖЕН быть пробел после каждой запятой.

```php
<?php
// неверно
function wrong_arguments($arg1 , $arg2) 
{ 
    // тело функции
}

// ВЕРНО
function right_arguments($arg1, $arg2) 
{ 
    // тело функции
}
```

Аргументы со значениями по умолчанию ДОЛЖНЫ располагаться в конце списка (после аргументов без значений по умолчанию).
Нарушение этого правила может привести ко вполне явным ошибкам выполнения программы, когда аргументу без значения по
умолчанию «не хватит» значения при вызове метода.

```php
<?php
// неверно
function wrong_arguments($is_null = null, $value, $array = []) 
{ 
    // тело функции
}

// ВЕРНО
function right_arguments($value, $is_null = null, $array = [])
{ 
    // тело функции
}
```

Список аргументов МОЖЕТ быть разделён на несколько строк, каждая из которых дополнена слева одним отступом (четырьмя
пробелами). В таком случае первый элемент списка аргументов ДОЛЖЕН начинаться с новой строки, и в каждой строке ДОЛЖЕН
быть указан только один аргумент.

В случае, если список аргументов разделён на несколько строк, закрывающая круглая скобка и открывающая фигурная скобка
ДОЛЖНЫ располагаться вместе на своей отдельной строке, а между ними должен быть один пробел.

```php
<?php
function very_long_function_name(
    $arg1, 
    $arg2,
    $arg3
) { 
    // тело функции
}
```

### Вызовы функций

В коде вызова функций НЕ ДОЛЖНО быть пробела между именем функции и открывающей круглой скобкой, НЕ ДОЛЖНО быть пробела
после открывающей круглой скобки, НЕ ДОЛЖНО быть пробела перед закрывающей круглой скобкой. В списке аргументов НЕ
ДОЛЖНО быть пробелов перед запятыми, но ДОЛЖЕН быть пробел после каждой запятой.

```php
<?php
foo();
foo($arg1, $arg2);
```

Список аргументов МОЖЕТ быть разделён на несколько строк, каждая из которых дополнена слева одним отступом (четырьмя
пробелами). В таком случае первый элемент списка аргументов ДОЛЖЕН начинаться с новой строки, и в каждой строке ДОЛЖЕН
быть указан только один аргумент.

```php
<?php
foo(
    $arg1, 
    $arg2
);
```

# Управляющие конструкции

Общие правила оформления управляющих конструкций:

* После ключевого слова, определяющего управляющую конструкцию, ДОЛЖЕН быть один пробел.
* После открывающих круглых скобок НЕ ДОЛЖНО быть пробелов.
* Перед закрывающими круглыми скобками НЕ ДОЛЖНО быть пробелов.
* Между закрывающей круглой скобкой и открывающей фигурной скобкой ДОЛЖЕН быть один пробел.
* Тело конструкции ДОЛЖНО быть дополнено одним отступом (четырьмя пробелами).
* Закрывающая фигурная скобка ДОЛЖНА располагаться на следующей строке после тела конструкции.

Тело каждой управляющей конструкции ДОЛЖНО быть заключено в фигурные скобки. Это позволяет стандартизировать внешний вид
управляющих конструкций снизить риск возникновения ошибок при добавлении новых строк в тело конструкции.

## Конструкции if, elseif и else

Конструкция `if` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и фигурные скобки, а также на
тот факт, что слова `else` и `elseif` располагаются в той же строке, что и закрывающая фигурная скобка предшествующего
тела конструкции.

```php
<?php
if ($expr1) {
    // тело if
} elseif ($expr2) {
    // тело elseif
} else {
    // тело else
}
```

Ключевое слово `elseif` СЛЕДУЕТ использовать вместо отдельного сочетания `else` и `if`. Так конструкция будет
представлять собой одно слово.

## Конструкции switch и case

Конструкция `switch` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и фигурные скобки.
Выражение case ДОЛЖНО быть смещено на один отступ (четыре пробела) от `switch`, а ключевое слово `break` (или иное
слово, обозначающее выход из конструкции) ДОЛЖНО располагаться на том же уровне отступов, что и тело case. В том случае,
когда в непустом теле case умышленно не используется break, ДОЛЖЕН быть комментарий в стиле `// no break`.

```php
<?php
switch ($expr) {
    case 0:
        echo 'First case, with a break';
        break;
    case 1:
        echo 'Second case, which falls through';
        // no break
    case 2:
    case 3:
    case 4:
        echo 'Third case, return instead of break';
        return;
    default:
        echo 'Default case';
        break;
}
```

## Конструкции while и do while

Конструкция `while` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и фигурные скобки.

```php
<?php
while ($expr) {
    // тело конструкции
}
```

Соответственно, конструкция `do while` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и
фигурные скобки.

```php
<?php
do {
    // тело конструкции
} while ($expr);
```

## Конструкция for

Конструкция `for` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и фигурные скобки.

```php
<?php
for ($i = 0; $i < 10; $i++) {
    // тело for
}
```

## Конструкция foreach

Конструкция `foreach` выглядит следующим образом. Обратите внимание на круглые скобки, пробелы и фигурные скобки.

```php
<?php
foreach ($iterable as $key => $value) {
    // тело foreach
}
```

---

## Побочные эффекты

В файлах СЛЕДУЕТ либо объявлять структуры (классы, функции, константы и т.п.) и не создавать побочных эффектов (
например: передавать данные в выходной поток, модифицировать настройки и т.п.), либо реализовывать логику, порождающую
побочные эффекты, но НЕ СЛЕДУЕТ делать одновременно и то, и другое.

Под «побочными эффектами» понимается реализация логики, не связанной с объявлением классов, функций, констант и т.п. –
даже подключение внешнего файла уже является «побочным эффектом».

«Побочные эффекты» включают (но не ограничиваются этим перечнем): передачу данных в выходной поток, явное использование
require или include, изменение настроек, генерирование ошибочных ситуаций или порождение исключений, изменение
глобальных или локальных переменных, чтение из файла или запись в файл и т.п.

Ниже представлен пример файла, содержащий в себе как объявления структур, так и порождение побочных эффектов, т.е.
ситуации, которой стоит избегать:

```php
<?php
// побочный эффект: изменение настроек
ini_set('error_reporting', E_ALL);
 
// побочный эффект: подключение файла
include "file.php";
 
// побочный эффект: передача данных в выходной поток
echo "\n";
 
// объявление
function foo()
{
    // тело функции
}
```

Следующий пример демонстрирует файл с объявлениями без побочных эффектов – т.е. образец рекомендуемой реализации:

```php
<?php
// объявление
function foo()
{
    // тело функции
}
 
// условное объявление -- это НЕ побочный эффект
if (! function_exists('bar')) {
    function bar()
    {
        // тело функции
    }
}
```

